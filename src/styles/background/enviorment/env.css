@import url('../root.css');

/* ============================================================
    Background elements - base container
    ============================================================ */
.bg-elements {
     position: absolute;
     inset: 0;
     pointer-events: none;
     z-index: 0;
     overflow: hidden;
     filter: saturate(1.05) contrast(0.95) opacity(0.7);
}

.bg-elements .bg-tree,
.bg-elements .bg-player,
.bg-elements .bg-creeper {
     z-index: 4;
}

/* ============================================================
    Sky (day/night blending) + stars
    ============================================================ */
.bg-elements .sky {
     position: absolute;
     inset: 0;
     z-index: 0;
     pointer-events: none;
}

/* base style for both day and night sky pseudo-layers */
.bg-elements .sky::before,
.bg-elements .sky::after {
     content: "";
     position: absolute;
     inset: 0;
     z-index: 0;
     transition: opacity 2s linear;
     background-repeat: no-repeat;
     background-size: cover;
}

/* Day gradient layer (visible during "day" portion of cycle) */
.bg-elements .sky::before {
     background: linear-gradient(180deg, var(--sky-day-top) 0%, var(--sky-day-mid) 60%, var(--sky-day-btm) 100%);
     opacity: 1;
     animation: dayFade 18s ease-in-out infinite;
}

/* Night gradient layer (fades in during "night" portion) */
.bg-elements .sky::after {
     background: linear-gradient(180deg, var(--sky-night-top) 0%, var(--sky-night-mid) 60%, var(--sky-night-btm) 100%);
     opacity: 0;
     animation: nightFade 18s ease-in-out infinite;
}

/* day/night fade keyframes */
@keyframes dayFade {
     0%   { opacity: 1; }
     55%  { opacity: 1; }
     65%  { opacity: 0; }
     95%  { opacity: 0; }
     100% { opacity: 1; }
}
@keyframes nightFade {
     0%   { opacity: 0; }
     55%  { opacity: 0; }
     65%  { opacity: 1; }
     95%  { opacity: 1; }
     100% { opacity: 0; }
}

/* Stars layer (appears during night) */
.bg-elements .stars {
     position: absolute;
     inset: 0;
     z-index: 2;
     opacity: 0;
     background-repeat: no-repeat;
     background-image:
          radial-gradient(2px 2px at 12% 25%, rgba(255,255,255,0.95) 50%, transparent 51%),
          radial-gradient(1.6px 1.6px at 33% 12%, rgba(255,255,255,0.85) 50%, transparent 51%),
          radial-gradient(1.8px 1.8px at 68% 22%, rgba(255,255,255,0.9) 50%, transparent 51%),
          radial-gradient(1.4px 1.4px at 82% 38%, rgba(255,255,255,0.8) 50%, transparent 51%),
          radial-gradient(1.5px 1.5px at 18% 62%, rgba(255,255,255,0.9) 50%, transparent 51%),
          radial-gradient(1.3px 1.3px at 54% 70%, rgba(255,255,255,0.75) 50%, transparent 51%),
          radial-gradient(1.7px 1.7px at 78% 80%, rgba(255,255,255,0.88) 50%, transparent 51%),
          radial-gradient(1.2px 1.2px at 8% 78%, rgba(255,255,255,0.8) 50%, transparent 51%);
     animation: starsCycle 18s ease-in-out infinite;
}
@keyframes starsCycle {
     0%   { opacity: 0; }
     55%  { opacity: 0; }
     65%  { opacity: 0.85; }
     90%  { opacity: 0.85; }
     100% { opacity: 0; }
}

/* ============================================================
    Sun and Moon motion paths
    ============================================================ */

/* Sun - visible during day portion, follows sunPath */
.bg-elements .sun {
     position: absolute;
     width: 18px;
     height: 18px;
     border-radius: 50%;
     background: radial-gradient(circle at 30% 30%, #fff7a1 0%, var(--text-gold) 60%, #e6a700 100%);
     box-shadow: 0 0 6px var(--text-gold), 0 0 12px rgba(255,210,77,0.45);
     z-index: 3;
     opacity: 0;
     animation: sunPath 18s ease-in-out infinite;
}
@keyframes sunPath {
     0%    { opacity: 0; left: -10%; bottom: -12px; }
     5%    { opacity: 1; }
     45%   { left: 30%; bottom: 18px; opacity: 1; }
     55%   { left: 45%; bottom: 26px; opacity: 1; }
     65%   { left: 105%; bottom: -12px; opacity: 0; }
     100%  { opacity: 0; left: 105%; bottom: -12px; }
}

/* Moon - visible during night portion, follows moonPath */
.bg-elements .moon {
     position: absolute;
     width: 14px;
     height: 14px;
     border-radius: 50%;
     background: radial-gradient(circle at 35% 35%, #ffffff 0%, #e6efff 65%, #a9b4cf 100%);
     box-shadow: 0 0 6px rgba(200,220,255,0.8), 0 0 10px rgba(200,220,255,0.45);
     z-index: 3;
     opacity: 0;
     animation: moonPath 18s ease-in-out infinite;
}
/* subtle craters/texture on the moon */
.bg-elements .moon::after {
     content: "";
     position: absolute;
     inset: 0;
     border-radius: 50%;
     background:
          radial-gradient(circle at 60% 40%, rgba(0,0,0,0.08) 0 20%, transparent 21%) no-repeat,
          radial-gradient(circle at 30% 65%, rgba(0,0,0,0.07) 0 18%, transparent 19%) no-repeat,
          radial-gradient(circle at 70% 70%, rgba(0,0,0,0.06) 0 14%, transparent 15%) no-repeat;
}
@keyframes moonPath {
     0%    { opacity: 0; left: -10%; bottom: -12px; }
     55%   { opacity: 0; left: 105%; bottom: -12px; }
     65%   { opacity: 1; left: 105%; bottom: -12px; }
     80%   { left: 50%; bottom: 22px; opacity: 1; }
     95%   { opacity: 1; }
     100%  { left: -10%; bottom: -12px; opacity: 0; }
}

/* Night overlay to darken the scene during night */
.bg-elements .night {
     position: absolute;
     inset: 0;
     z-index: 5;
     pointer-events: none;
     mix-blend-mode: multiply;
     background: rgba(0,0,0,0.9);
     opacity: 0;
     animation: nightCycle 18s ease-in-out infinite;
}
@keyframes nightCycle {
     0%   { opacity: 0; }
     55%  { opacity: 0; }
     65%  { opacity: 0.55; }
     95%  { opacity: 0.55; }
     100% { opacity: 0; }
}

/* ============================================================
    Trees (visuals + interactions)
    ============================================================ */

/* base tree container and visual tweak */
.bg-tree {
     position: absolute;
     image-rendering: pixelated;
     filter: drop-shadow(2px 4px 0 rgba(0,0,0,0.4));
}

/* per-tree placement and sizing (keeps them deterministic) */
.bg-tree.t1 { left: 12px;  bottom: -8px; width: 24px; height: 44px; }
.bg-tree.t2 { right: 15px; bottom: -6px; width: 28px; height: 40px; }
.bg-tree.t3 { left: 140px; bottom: -10px; width: 20px; height: 36px; }
.bg-tree.t4 { right: 120px; bottom: -4px; width: 22px; height: 38px; }
.bg-tree.t5 { left: 240px; bottom: -8px; width: 26px; height: 42px; }

/* gentle continuous sway for all trees; slightly varied durations below */
.bg-tree { animation: sway 4s ease-in-out infinite; }
.bg-tree.t1 { animation-duration: 4.2s; }
.bg-tree.t2 { animation-duration: 3.8s; }
.bg-tree.t3 { animation-duration: 4.5s; }
.bg-tree.t4 { animation-duration: 4.1s; }
.bg-tree.t5 { animation-duration: 3.9s; }

/* sway keyframes rotate the tree around its origin */
@keyframes sway {
     0%   { transform: rotate(0deg); }
     25%  { transform: rotate(1deg); }
     75%  { transform: rotate(-1deg); }
     100% { transform: rotate(0deg); }
}

/* clickable trees: allow pointer interaction and focus styling */
.bg-tree-clickable { cursor: pointer; pointer-events: auto; }
.bg-tree-clickable:focus-visible { outline: 2px solid var(--text-gold); outline-offset: 4px; }

/* shake animation used for an immediate interaction feedback (non-looping) */
.bg-tree.shake { animation: tree-shake 640ms ease; transform-origin: 50% 80%; }
@keyframes tree-shake {
     0%   { transform: rotate(0deg) translateY(0); }
     20%  { transform: rotate(-6deg) translateY(-2px); }
     40%  { transform: rotate(5deg) translateY(-1px); }
     60%  { transform: rotate(-3deg) translateY(0); }
     80%  { transform: rotate(2deg) translateY(-1px); }
     100% { transform: rotate(0deg) translateY(0); }
}

/* trunk element - positioned at the base of each tree */
.tree-trunk {
     position: absolute;
     bottom: 0;
     left: 50%;
     transform: translateX(-50%);
     width: 8px;
     height: 24px;
     background: linear-gradient(90deg, #8b4513, #654321);
     border: 1px solid rgba(0,0,0,0.3);
}

/* leaves block (simple pixel-art-ish shape) */
.tree-leaves {
     position: absolute;
     bottom: 16px;
     left: 50%;
     transform: translateX(-50%);
     width: 20px;
     height: 20px;
     background: linear-gradient(135deg, #228b22, #006400);
     border: 1px solid rgba(0,0,0,0.2);
     border-radius: 2px;
}

/* ============================================================
    Leaves falling animation for individual leaf elements
    ============================================================ */
.bg-tree .leaf {
     position: absolute;
     width: 6px;
     height: 6px;
     border-radius: 2px;
     box-shadow: 0 1px 0 rgba(0,0,0,0.25);
     image-rendering: pixelated;
     transform-origin: center;
     animation: leaf-fall 1100ms cubic-bezier(.2,.7,.2,1) forwards;
     pointer-events: none;
}
@keyframes leaf-fall {
     0%   { transform: translate(0,0) rotate(0deg); opacity: 1; }
     30%  { transform: translate(var(--tx), var(--ty)) rotate(var(--rot)); opacity: 1; }
     100% { transform: translate(calc(var(--tx) * 1.4), calc(var(--ty) + 30px)) rotate(calc(var(--rot) + 90deg)); opacity: 0; }
}